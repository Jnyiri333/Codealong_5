---
title: "Codealong_5"
author: "Jake Nyiri"
date: "11/7/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(palmerpenguins)
library(effsize)
library(broom)
library(ggbeeswarm)
library(car)
```
#T-TEST 1

```{r}
#compoare mass between male/female chinstrap penguins

chinstrap_penguins <- penguins %>% 
  filter(species == "Chinstrap")

#basic histogram of masses
chin_hist <- chinstrap_penguins %>% 
  ggplot(aes(x = body_mass_g))+
  geom_histogram(bins = 10)+
  facet_wrap(~sex)

chin_hist

#Do a qq plot to explore normality

chin_qq <- chinstrap_penguins %>% 
  ggplot(aes(sample = body_mass_g))+
  geom_qq()+
  facet_wrap(~sex)

chin_qq

```
```{r}
#get descriptive stats of chinstraps

chin_stat <- chinstrap_penguins %>% 
  group_by(sex) %>% 
  summarize(
    mean = mean(body_mass_g),
    median = median(body_mass_g),
    sd = sd(body_mass_g),
    sample_size = n())


chin_stat

```

```{r}
#Going to do a t-tst or anova or some shit
#Firwt get vectors of mass for m/f chinstraps to ue t-test

male_chinstrap_mass <-chinstrap_penguins %>% 
  filter(sex == "female") %>% 
  pull(body_mass_g)

female_chinstrap_mass <- chinstrap_penguins %>%
  filter(sex == "male") %>% 
  pull(body_mass_g)

###do the tests

#IS there sig dif in the masses?
chinstrap_test <- 
  t.test(male_chinstrap_mass, female_chinstrap_mass)

chinstrap_test

#cohen d effect size time!
chinstrap_cohen<-
  cohen.d(male_chinstrap_mass, female_chinstrap_mass)

chinstrap_cohen

#Are male cp sign. larger than fem. peng?
#Is one-sided test, could I have gotten 'this large' or greater of difference by random sample (Not 'this distance away')

chinstrap_size_compare<-t.test(female_chinstrap_mass,male_chinstrap_mass, alternative = "greater") #must line up with order of arguments (is male greater than female)
#This is backwards! Not sure why--in codealong video these are reversed and it works! WHy is my test running backwards?


chinstrap_size_compare

```

